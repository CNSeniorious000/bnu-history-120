<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title> {{ title }} </title>
    <link rel="stylesheet" href="/common.css">
    <!--<link rel="stylesheet" href="/common-light.css" media="(prefers-color-scheme: light)">-->
    <!--<link rel="stylesheet" href="/common-dark.css" media="(prefers-color-scheme: dark)">-->
    <!--<link rel="icon" href="/icon/favicon.svg" type="image/svg+xml">-->
    <link rel="icon" href="/icon/favicon.png" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icon/apple-touch-icon-180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icon/apple-touch-icon-167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="128x128" href="/icon/apple-touch-icon-128.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;300;400;500;600;700;900&display=swap">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
</head>
<body>
<div id="everything">
    <div id="article">
        <article>
            <div id="markdown">
                <h1> {{ name }} </h1>
                {% autoescape off %} {{ markdown }} {% endautoescape %}
            </div>
        </article>
    </div>
    <div id="footer">
        <footer>
            <div id="sitemap">
                {% for university in universities %}
                    <h3><a href="/{{ university }}" class="subtitle">{{ university.full_name }}</a></h3>
                    <div class="university">
                        {% for category in university.categories %}
                            <div class="category">
                                <h4> {{ category }} </h4>
                                {% for person in university.filter_category(category) %}
                                    <a href="/{{ university }}/{{ category }}/{{ person }}">{{ person }}</a>
                                {% endfor %}
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
            </div>
        </footer>
    </div>
</div>
<template id="preloader">
    <link rel="prefetch">
</template>
</body>
<script>
    const preloader = document.getElementById("preloader").content
    const head = document.head
    const loaded = new Set()

    function addPreloadHook(event) {
        let node = event.target
        console.assert(node.nodeName === "A", node.nodeName)
        let href = node.href

        if (loaded.has(href)) return  // TODO: check same-origin

        let link = preloader.cloneNode(true).querySelector("link")
        link.href = href
        head.appendChild(link)
        loaded.add(href)
    }

    for (a of document.querySelectorAll("a")) a.onmouseenter = addPreloadHook

</script>
</html>